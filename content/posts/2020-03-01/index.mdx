---
title: Google Colab で BERT を用いた感情分析ハンズオン
author: Kenya Hondoh
date: 2019-03-01
hero: ./images/google-colab.jpg
excerpt: Google Colab で BERT を用いた感情分析をハンズオンしてみた。
---

## TL;DR
- 社でNLP（自然言語処理）のビジネス事例のサーベイをする機会があり，ついでに BERT という今一番アツいと言われているモデルで遊んでみた。
- Google Colab では，GPU などの計算資源をこちらで用意せずに使えるのですごい。
- 感情分析（文章のネガティブ・ポジティブ2値分類）を試したところ，まあまあ良さげな結果が得られた。

## やったこと
- [Google Colab で BERT を動かすハンズオン用 Notebook](https://colab.research.google.com/drive/1XudvwM2iy3yudE0tDlU-UCNIyrRjazC0?userstoinvite=kenmikanmi%40gmail.com&actionButton=1#scrollTo=xiYrZKaHwV81) を動かしてみた
- Notebook で実施している内容：
    - 準備・前処理
        - ライブラリの import
        - データセットのダウンロード
        - データの前処理
    - 訓練
    - テスト
    - 推論
        - 訓練済みモデルに任意の入力をやってみる

- 実施した手順は以下の場所にあります：
    - [Google Colab](https://colab.research.google.com/drive/1XudvwM2iy3yudE0tDlU-UCNIyrRjazC0?userstoinvite=kenmikanmi%40gmail.com&actionButton=1#scrollTo=xiYrZKaHwV81)
    - [Github](https://github.com/kenmikanmi/bert_playground/blob/master/Predicting_Movie_Reviews_with_BERT_on_TF_Hub.ipynb)

## 結果
入力 | 推論結果 | 判定
--- | --- | ---
XXX's AI technologies are great! I'll recommend them to my partners! | Positive | ○
XXX announced new technology which improves late computing speed and bad performance | Negative | ×
XXX announced new technology which improves computing speed and performance | Positive | ○

2行目は，ネガティブな単語を用いているけど文章としてはポジティブな例です。推論結果はネガティブになっています。

一方，3行目で，文の大きな意味を変えずにネガティブな単語を抜いてみたところ，ポジティブという推論結果になりました。

結果だけ見ると，文章の意味でのネガポジと言うより，単語レベルでのネガポジに引っ張られているような感じがありますね。